"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:true});exports.assert=assert;exports.currentISOTime=currentISOTime;exports.currentTimestamp=currentTimestamp;exports.isPromise=void 0;exports.removeTrailingSlash=removeTrailingSlash;exports.retriable=retriable;exports.safeSetTimeout=safeSetTimeout;var _regenerator=_interopRequireDefault(require("@babel/runtime/regenerator"));var _asyncToGenerator2=_interopRequireDefault(require("@babel/runtime/helpers/asyncToGenerator"));function assert(truthyValue,message){if(!truthyValue){throw new Error(message);}}function removeTrailingSlash(url){return url===null||url===void 0?void 0:url.replace(/\/+$/,'');}function retriable(_x,_x2){return _retriable.apply(this,arguments);}function _retriable(){_retriable=(0,_asyncToGenerator2["default"])(_regenerator["default"].mark(function _callee(fn,props){var lastError,i,res;return _regenerator["default"].wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:lastError=null;i=0;case 2:if(!(i<props.retryCount+1)){_context.next=21;break;}if(!(i>0)){_context.next=6;break;}_context.next=6;return new Promise(function(r){return setTimeout(r,props.retryDelay);});case 6:_context.prev=6;_context.next=9;return fn();case 9:res=_context.sent;return _context.abrupt("return",res);case 13:_context.prev=13;_context.t0=_context["catch"](6);lastError=_context.t0;if(props.retryCheck(_context.t0)){_context.next=18;break;}throw _context.t0;case 18:i++;_context.next=2;break;case 21:throw lastError;case 22:case"end":return _context.stop();}},_callee,null,[[6,13]]);}));return _retriable.apply(this,arguments);}function currentTimestamp(){return new Date().getTime();}function currentISOTime(){return new Date().toISOString();}function safeSetTimeout(fn,timeout){var t=setTimeout(fn,timeout);(t===null||t===void 0?void 0:t.unref)&&(t===null||t===void 0?void 0:t.unref());return t;}var isPromise=exports.isPromise=function isPromise(obj){return obj&&typeof obj.then==='function';};